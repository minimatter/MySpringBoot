<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="index.html">


<div layout:fragment="content" class="main ">

    <blockquote class="layui-elem-quote">
        <h1 style="display: inline">欢迎登录!：</h1>
        <h1 style="display: inline" th:text="${session.user.userName}"></h1>
    </blockquote>

    <div th:switch="${session.user.rid}">
        <h2 th:case="'1'" style="color: #5FB878">您拥有管理员权限</h2>
        <h2 th:case="'2'" style="color: #5FB878">您拥有雇员权限</h2>
        <h2 th:case="'3'" style="color: #5FB878">您拥有用户权限</h2>
    </div>

    <div>
        <a th:href="@{../user/toUserEdit(id=${session.user.id})}">
            <button type="button" class="layui-btn">修改账号信息</button>
        </a>
    </div>
    <br>
    <br>
    <table class="layui-table" lay-size="lg">
        <thead>
        <tr>
            <th>序号</th>
            <th>用户名</th>
            <th>密码</th>
            <th>用户类型</th>
            <th>操作</th>
        </tr>

        </thead>

        <tbody>


        <tr th:each="user,userStat  : ${userList}">
            <div th:if="${user.id} !=${session.user.id}">
                <td th:text="${userStat.index+1}"></td>
                <td th:text="${user.userName}"></td>
                <td th:text="${user.passWord}"></td>
                <td th:text="${user.ridStr}"></td>
                <td>


                    <button th:onclick="'alter('+${user.id}+')'" type="button" class="layui-btn layui-btn-sm">修改用户信息
                    </button>

                    <a th:onclick="'userDelete('+${user.id}+')'">
                        <button type="button" class="layui-btn layui-btn-sm layui-btn-danger">删除用户</button>
                    </a>
                </td>
            </div>

        </tr>

        </tbody>


    </table>


    <div style="text-align: center">
        <span th:text="${warnStr} "></span>
    </div>
    <!-- 分页 -->
    <div th:replace="base/pagination :: pagination('toUserList')"></div>


    <script>

        function userDelete(id) {
            var temp = [[${session.user.rid}]];
            if (temp == "1") {
                $.ajax({
                    url: 'userDelete',
                    type: 'get',
                    data: 'id=' + id,
                    success: function () {

                        layer.msg("删除成功!");
                        location.reload();
                    }
                })
            } else layer.msg("权限不足!");

        }


        function alter(id) {
            var temp = [[${session.user.rid}]];
            if (temp == "1") {
                window.location.href = "../user/toUserEdit?id=" + id;
                // window.open("../user/toUserEdit?id="+id);
            } else layer.msg("权限不足!");

        }

    </script>
</div>


